config {
  type: "assertion",
  schema: "your_schema",
  name: "assert_campaigns"
}

select
  count(*) as invalid_count
from (
  select campaign_id, count(*) 
  from ${ref('view_campaigns')}
  group by campaign_id
  having count(*) > 1
) as duplicates
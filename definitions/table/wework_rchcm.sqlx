config {
  type: "table",
  schema: "sale"
}

SELECT DISTINCT * EXCEPT(row_number)
FROM (
SELECT * EXCEPT(tags),
    ROW_NUMBER() OVER (PARTITION BY task_id ORDER BY update_time DESC) AS row_number
FROM ${ref('raw_wework_rchcm')}
) t
WHERE t.row_number = 1